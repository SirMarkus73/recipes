---
import type { MealAPIResponse } from "../types/mealApiResponse";

const respone = await fetch(
  "https://www.themealdb.com/api/json/v1/1/random.php"
);

if (!respone.ok) {
  throw new Error(`Failed to fetch data from API: ${respone.status}`);
}

const results = (await respone.json()) as MealAPIResponse;

if (results) {
  return Astro.redirect(`/meal/${results.meals[0].strMeal}`);
} else {
  return Astro.redirect("/");
}
---
